<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MQNotebook ‚Äî Enterprise-Grade RAG System | Muhammad Qasim</title><meta name=keywords content="RAG,Retrieval Augmented Generation,Enterprise AI,Document Search,LLM Infrastructure"><meta name=description content="MQNotebook is a production-ready Retrieval-Augmented Generation (RAG) engine designed for messy, real-world enterprise documents."><meta name=author content="Muhammad Qasim"><link rel=canonical href=https://kas-sim.github.io/systems/mqnotebook/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=https://kas-sim.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kas-sim.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kas-sim.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kas-sim.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kas-sim.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://kas-sim.github.io/systems/mqnotebook/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><meta property="og:url" content="https://kas-sim.github.io/systems/mqnotebook/"><meta property="og:site_name" content="Muhammad Qasim"><meta property="og:title" content="MQNotebook ‚Äî Enterprise-Grade RAG System"><meta property="og:description" content="MQNotebook is a production-ready Retrieval-Augmented Generation (RAG) engine designed for messy, real-world enterprise documents."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="systems"><meta property="og:image" content="https://kas-sim.github.io/images/mqnotebook-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kas-sim.github.io/images/mqnotebook-cover.png"><meta name=twitter:title content="MQNotebook ‚Äî Enterprise-Grade RAG System"><meta name=twitter:description content="MQNotebook is a production-ready Retrieval-Augmented Generation (RAG) engine designed for messy, real-world enterprise documents."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Systems","item":"https://kas-sim.github.io/systems/"},{"@type":"ListItem","position":2,"name":"MQNotebook ‚Äî Enterprise-Grade RAG System","item":"https://kas-sim.github.io/systems/mqnotebook/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MQNotebook ‚Äî Enterprise-Grade RAG System","name":"MQNotebook ‚Äî Enterprise-Grade RAG System","description":"MQNotebook is a production-ready Retrieval-Augmented Generation (RAG) engine designed for messy, real-world enterprise documents.","keywords":["RAG","Retrieval Augmented Generation","Enterprise AI","Document Search","LLM Infrastructure"],"articleBody":" Overview MQNotebook is a production-ready, local-first Retrieval-Augmented Generation (RAG) system built to handle the messy reality of enterprise documents.\nUnlike typical ‚Äúchat with PDF‚Äù demos, MQNotebook is engineered to ingest:\nscanned PDFs, complex Excel spreadsheets, PowerPoint decks with speaker notes, and mixed-format document collections, while running securely on a local machine or cloud environment.\nüîó Live Demo: https://mqnotebook.streamlit.app/\nWhy MQNotebook Exists Most Retrieval-Augmented Generation (RAG) demos assume an ideal world: clean PDFs, perfect text extraction, and well-structured documents.\nEnterprise reality is different.\nIn real environments, knowledge lives in:\nscanned documents poorly formatted PDFs spreadsheets with implicit structure slide decks where critical context lives in speaker notes Most RAG pipelines fail before retrieval even begins ‚Äî at ingestion.\nMQNotebook exists to address this gap.\nInstead of optimizing for model size or prompt tricks, MQNotebook focuses on:\nfailure-first document ingestion retrieval precision over raw recall controlled context passed to the LLM The system is designed so that the language model only sees high-confidence, conceptually relevant information, reducing hallucinations and wasted tokens.\nDesign Philosophy Most RAG demos assume clean text input.\nMQNotebook assumes documents will fail ‚Äî and designs for that failure.\nThe system prioritizes:\ndeterministic ingestion, retrieval precision, and controlled LLM exposure. System Architecture MQNotebook follows a multi-stage retrieval pipeline that separates document ingestion, retrieval, and reasoning.\nDocument Ingestion Layer Scanned PDFs \u0026 Images\nOCR fallback using Tesseract + Poppler when text extraction fails.\nPowerPoint (.pptx)\nExtracts text from slides, shapes, SmartArt, and speaker notes.\nExcel (.xlsx)\nParses spreadsheets row-by-row while preserving column structure.\nAll extracted content is normalized before embedding.\nRetrieval \u0026 Ranking Layer Vector Store: ChromaDB Embeddings: BAAI/bge-small-en-v1.5 (runs locally on CPU) Retriever: Top-K semantic search Reranker: Cross-encoder to filter results before LLM inference This reduces hallucinations by ensuring only conceptually relevant context reaches the model.\nGeneration Layer LLM: Gemini 2.0 Flash (via OpenRouter) Large context window Fast reasoning Controlled prompt scope API keys are handled in-memory per session and cleared on reset.\nEngineering Considerations Windows File Locking Fix\nDynamic, timestamped sessions prevent WinError 32 during vector store resets.\nOS-Aware Execution\nAutomatically switches OCR binary paths between Windows (local) and Linux (cloud).\nLocal-First Security Model\nDocuments and embeddings remain local; only final prompts are sent to the LLM.\nRelationship to DevShelf MQNotebook complements DevShelf, which focuses on classic information retrieval and search engines.\nDevShelf: First-principles search engine (TF-IDF, inverted index, ranking) MQNotebook: Modern RAG system (embeddings, reranking, LLM integration) Together, they demonstrate a full spectrum of search and knowledge retrieval systems ‚Äî from traditional IR to AI-augmented reasoning.\nSource \u0026 Documentation Source Code: https://github.com/Kas-sim/MQNotebook DevShelf: https://github.com/Kas-sim/DevShelf ","wordCount":"426","inLanguage":"en","image":"https://kas-sim.github.io/images/mqnotebook-cover.png","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Muhammad Qasim"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kas-sim.github.io/systems/mqnotebook/"},"publisher":{"@type":"Organization","name":"Muhammad Qasim","logo":{"@type":"ImageObject","url":"https://kas-sim.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://kas-sim.github.io/ accesskey=h title="Muhammad Qasim (Alt + H)">Muhammad Qasim</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kas-sim.github.io/systems/ title=Systems><span>Systems</span></a></li><li><a href=https://kas-sim.github.io/rag-notes/ title="RAG Notes"><span>RAG Notes</span></a></li><li><a href=https://kas-sim.github.io/tools/ title=Tools><span>Tools</span></a></li><li><a href=https://kas-sim.github.io/archives/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kas-sim.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://kas-sim.github.io/systems/>Systems</a></div><h1 class="post-title entry-hint-parent">MQNotebook ‚Äî Enterprise-Grade RAG System</h1><div class=post-description>MQNotebook is a production-ready Retrieval-Augmented Generation (RAG) engine designed for messy, real-world enterprise documents.</div><div class=post-meta><span>Muhammad Qasim</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/Kas-sim/MQNotebook rel="noopener noreferrer edit" target=_blank>View Source Code</a></span></div></header><figure class=entry-cover><img loading=eager src=https://kas-sim.github.io/images/mqnotebook-cover.png alt="MQNotebook Architecture Overview"><figcaption>Enterprise-grade RAG with brute-force document ingestion and precision reranking</figcaption></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#overview aria-label=Overview>Overview</a></li><li><a href=#why-mqnotebook-exists aria-label="Why MQNotebook Exists">Why MQNotebook Exists</a></li><li><a href=#design-philosophy aria-label="Design Philosophy">Design Philosophy</a></li><li><a href=#system-architecture aria-label="System Architecture">System Architecture</a><ul><li><a href=#document-ingestion-layer aria-label="Document Ingestion Layer">Document Ingestion Layer</a></li><li><a href=#retrieval--ranking-layer aria-label="Retrieval & Ranking Layer">Retrieval & Ranking Layer</a></li><li><a href=#generation-layer aria-label="Generation Layer">Generation Layer</a></li></ul></li><li><a href=#engineering-considerations aria-label="Engineering Considerations">Engineering Considerations</a></li><li><a href=#relationship-to-devshelf aria-label="Relationship to DevShelf">Relationship to DevShelf</a></li><li><a href=#source--documentation aria-label="Source & Documentation">Source & Documentation</a></li></ul></div></details></div><div class=post-content><hr><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p><strong>MQNotebook</strong> is a <strong>production-ready, local-first Retrieval-Augmented Generation (RAG) system</strong> built to handle the <em>messy reality</em> of enterprise documents.</p><p>Unlike typical ‚Äúchat with PDF‚Äù demos, MQNotebook is engineered to ingest:</p><ul><li>scanned PDFs,</li><li>complex Excel spreadsheets,</li><li>PowerPoint decks with speaker notes,</li><li>and mixed-format document collections,</li></ul><p>while running securely on a local machine or cloud environment.</p><p>üîó <strong>Live Demo:</strong> <a href=https://mqnotebook.streamlit.app/>https://mqnotebook.streamlit.app/</a></p><hr><h2 id=why-mqnotebook-exists>Why MQNotebook Exists<a hidden class=anchor aria-hidden=true href=#why-mqnotebook-exists>#</a></h2><p>Most Retrieval-Augmented Generation (RAG) demos assume an ideal world:
clean PDFs, perfect text extraction, and well-structured documents.</p><p>Enterprise reality is different.</p><p>In real environments, knowledge lives in:</p><ul><li>scanned documents</li><li>poorly formatted PDFs</li><li>spreadsheets with implicit structure</li><li>slide decks where critical context lives in speaker notes</li></ul><p>Most RAG pipelines fail <strong>before retrieval even begins</strong> ‚Äî at ingestion.</p><p>MQNotebook exists to address this gap.</p><p>Instead of optimizing for model size or prompt tricks, MQNotebook focuses on:</p><ul><li><strong>failure-first document ingestion</strong></li><li><strong>retrieval precision over raw recall</strong></li><li><strong>controlled context passed to the LLM</strong></li></ul><p>The system is designed so that the language model only sees <strong>high-confidence, conceptually relevant information</strong>, reducing hallucinations and wasted tokens.</p><hr><h2 id=design-philosophy>Design Philosophy<a hidden class=anchor aria-hidden=true href=#design-philosophy>#</a></h2><p>Most RAG demos assume clean text input.<br>MQNotebook assumes <strong>documents will fail</strong> ‚Äî and designs for that failure.</p><p>The system prioritizes:</p><ul><li>deterministic ingestion,</li><li>retrieval precision,</li><li>and controlled LLM exposure.</li></ul><hr><h2 id=system-architecture>System Architecture<a hidden class=anchor aria-hidden=true href=#system-architecture>#</a></h2><p>MQNotebook follows a <strong>multi-stage retrieval pipeline</strong> that separates document ingestion, retrieval, and reasoning.</p><h3 id=document-ingestion-layer>Document Ingestion Layer<a hidden class=anchor aria-hidden=true href=#document-ingestion-layer>#</a></h3><ul><li><p><strong>Scanned PDFs & Images</strong><br>OCR fallback using Tesseract + Poppler when text extraction fails.</p></li><li><p><strong>PowerPoint (.pptx)</strong><br>Extracts text from slides, shapes, SmartArt, and <strong>speaker notes</strong>.</p></li><li><p><strong>Excel (.xlsx)</strong><br>Parses spreadsheets row-by-row while preserving column structure.</p></li></ul><p>All extracted content is normalized before embedding.</p><hr><h3 id=retrieval--ranking-layer>Retrieval & Ranking Layer<a hidden class=anchor aria-hidden=true href=#retrieval--ranking-layer>#</a></h3><ul><li><strong>Vector Store:</strong> ChromaDB</li><li><strong>Embeddings:</strong> BAAI/bge-small-en-v1.5 (runs locally on CPU)</li><li><strong>Retriever:</strong> Top-K semantic search</li><li><strong>Reranker:</strong> Cross-encoder to filter results before LLM inference</li></ul><p>This reduces hallucinations by ensuring only <em>conceptually relevant</em> context reaches the model.</p><hr><h3 id=generation-layer>Generation Layer<a hidden class=anchor aria-hidden=true href=#generation-layer>#</a></h3><ul><li><strong>LLM:</strong> Gemini 2.0 Flash (via OpenRouter)</li><li>Large context window</li><li>Fast reasoning</li><li>Controlled prompt scope</li></ul><p>API keys are handled in-memory per session and cleared on reset.</p><hr><h2 id=engineering-considerations>Engineering Considerations<a hidden class=anchor aria-hidden=true href=#engineering-considerations>#</a></h2><ul><li><p><strong>Windows File Locking Fix</strong><br>Dynamic, timestamped sessions prevent <code>WinError 32</code> during vector store resets.</p></li><li><p><strong>OS-Aware Execution</strong><br>Automatically switches OCR binary paths between Windows (local) and Linux (cloud).</p></li><li><p><strong>Local-First Security Model</strong><br>Documents and embeddings remain local; only final prompts are sent to the LLM.</p></li></ul><hr><h2 id=relationship-to-devshelf>Relationship to DevShelf<a hidden class=anchor aria-hidden=true href=#relationship-to-devshelf>#</a></h2><p>MQNotebook complements <strong>DevShelf</strong>, which focuses on <strong>classic information retrieval and search engines</strong>.</p><ul><li><strong>DevShelf:</strong> First-principles search engine (TF-IDF, inverted index, ranking)</li><li><strong>MQNotebook:</strong> Modern RAG system (embeddings, reranking, LLM integration)</li></ul><p>Together, they demonstrate a full spectrum of <strong>search and knowledge retrieval systems</strong> ‚Äî from traditional IR to AI-augmented reasoning.</p><hr><h2 id=source--documentation>Source & Documentation<a hidden class=anchor aria-hidden=true href=#source--documentation>#</a></h2><ul><li><strong>Source Code:</strong> <a href=https://github.com/Kas-sim/MQNotebook>https://github.com/Kas-sim/MQNotebook</a></li><li><strong>DevShelf:</strong> <a href=https://github.com/Kas-sim/DevShelf>https://github.com/Kas-sim/DevShelf</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://kas-sim.github.io/>Muhammad Qasim</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>